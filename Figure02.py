"""
A Flexible Snow Model (FSM 2.1.1) including a forest canopy
Figure 2. Shortwave radiation fluxes, sensible heat fluxes, temperatures and aerodynamic resistance
in one-layer (left) and two-layer (right) canopy models. Arrows show the directions in which fluxes
are defined to be positive. Longwave radiation and moisture fluxes are numbered and directed in the
same ways as shortwave radiation and sensible heat fluxes, respectively.
"""

import matplotlib.pyplot as plt

plt.rcParams['font.size'] = 20
plt.rcParams['mathtext.fontset'] = 'cm'
plt.rcParams['font.family'] = 'STIXGeneral'
fig = plt.figure(figsize=(18,6))

plt.subplot(121)
plt.plot([0,1],[0,0],'k')
plt.plot([0,0.6,0.6,0,0],[0.25,0.25,0.75,0.75,0.25],'k')
plt.plot([0,0.95],[1,1],'k--')
plt.plot([0.9,0.9],[0,0.15],'k')
plt.plot([0.87,0.93,0.93,0.87,0.87],[0.15,0.15,0.35,0.35,0.15],'k')
plt.plot([0.9,0.9],[0.35,0.65],'k')
plt.plot([0.87,0.93,0.93,0.87,0.87],[0.65,0.65,0.85,0.85,0.65],'k')
plt.plot([0.9,0.9],[0.85,1],'k')
plt.plot([0.6,0.67],[0.5,0.5],'k')
plt.plot([0.83,0.9],[0.5,0.5],'k')
plt.plot([0.67,0.83,0.83,0.67,0.67],[0.45,0.45,0.55,0.55,0.45],'k')
plt.arrow(0.7,0.575,0.07,0,color='k',head_width=0.03,head_length=0.02)
plt.arrow(0.95,0.2,0,0.1,color='k',head_width=0.02)
plt.arrow(0.95,0.7,0,0.1,color='k',head_width=0.02)
plt.text(0.9,0.25,'$r_s$',horizontalalignment='center',verticalalignment='center')
plt.text(0.96,0.25,'$H_s$',verticalalignment='center')
plt.text(0.9,0.75,'$r_a$',horizontalalignment='center',verticalalignment='center')
plt.text(0.75,0.5,'$r_v$',horizontalalignment='center',verticalalignment='center')
plt.text(0.75,0.625,'$H_v$',horizontalalignment='center')
plt.text(0.96,0.75,'$H$',verticalalignment='center')
plt.text(0.9,-0.07,'$T_s$',horizontalalignment='center')
plt.text(0.93,0.5,'$T_c$',verticalalignment='center')
plt.text(0.97,1,'$T_a$',horizontalalignment='center',verticalalignment='center')
plt.text(0.53,0.5,'$T_v$',verticalalignment='center')
plt.text(-0.05,1,'$z_T$',verticalalignment='center')
plt.text(-0.05,0.75,'$h_c$',verticalalignment='center')
plt.text(-0.05,0.5,'$z_1$',verticalalignment='center')
plt.text(-0.05,0.25,'$h_b$',verticalalignment='center')
plt.text(-0.05,0.0,'$z_{0h}$',verticalalignment='center')

plt.arrow(0.15,0.85+0.03,0,-0.1,color='k',head_width=0.02)
plt.text(0.15,0.92,r'$S_{\downarrow\rm dir}$',horizontalalignment='center')
plt.arrow(0.15,0.25,0,-0.1,color='k',head_width=0.02)
plt.text(0.15,0.05,r'$\tau_b S_{\downarrow\rm dir}$',horizontalalignment='center')
plt.arrow(0.3,0.85+0.03,0,-0.1,color='k',head_width=0.02)
plt.text(0.3,0.92,r'$S_{\downarrow\rm dif}$',horizontalalignment='center')
plt.arrow(0.3,0.25,0,-0.1,color='k',head_width=0.02)
plt.text(0.3,0.05,r'$S_{\downarrow1}$',horizontalalignment='center')
plt.arrow(0.45,0.15-0.03,0,0.1,color='k',head_width=0.02)
plt.text(0.45,0.05,r'$S_{\uparrow1}$',horizontalalignment='center')
plt.arrow(0.45,0.75,0,0.1,color='k',head_width=0.02)
plt.text(0.45,0.92,r'$S_{\uparrow0}$',horizontalalignment='center')

plt.text(0.01,-0.05,'surface')
plt.text(0.01,0.5,'canopy',verticalalignment='center')
plt.text(0.01,1.05,'atmosphere',verticalalignment='center')
plt.ylim(-0.1,1)
plt.axis('off')

plt.subplot(122)
plt.plot([0,1],[0,0],'k')
plt.plot([0,0.6,0.6,0,0],[0.25,0.25,0.75,0.75,0.25],'k')
plt.plot([0,0.6],[0.5,0.5],'k')
plt.plot([0,0.95],[1,1],'k--')
plt.plot([0.9,0.9],[0,0.085],'k')
plt.plot([0.87,0.93,0.93,0.87,0.87],[0.085,0.085,0.285,0.285,0.085],'k')
plt.plot([0.9,0.9],[0.285,0.425],'k')
plt.plot([0.87,0.93,0.93,0.87,0.87],[0.425,0.425,0.575,0.575,0.425],'k')
plt.plot([0.9,0.9],[0.575,0.715],'k')
plt.plot([0.87,0.93,0.93,0.87,0.87],[0.715,0.715,0.915,0.915,0.715],'k')
plt.plot([0.9,0.9],[0.915,1],'k')
plt.plot([0.6,0.67],[0.625,0.625],'k')
plt.plot([0.83,0.9],[0.625,0.625],'k')
plt.plot([0.67,0.83,0.83,0.67,0.67],[0.575,0.575,0.675,0.675,0.575],'k')
plt.plot([0.6,0.67],[0.375,0.375],'k')
plt.plot([0.83,0.9],[0.375,0.375],'k')
plt.plot([0.67,0.83,0.83,0.67,0.67],[0.325,0.325,0.425,0.425,0.325],'k')
plt.arrow(0.95,0.135,0,0.1,color='k',head_width=0.02)
plt.arrow(0.95,0.45,0,0.1,color='k',head_width=0.02)
plt.arrow(0.95,0.765,0,0.1,color='k',head_width=0.02)
plt.arrow(0.7,0.7,0.07,0,color='k',head_width=0.03,head_length=0.02)
plt.arrow(0.7,0.45,0.07,0,color='k',head_width=0.03,head_length=0.02)
plt.text(0.9,0.185,'$r_s$',horizontalalignment='center',verticalalignment='center')
plt.text(0.75,0.625,'$r_{v,1}$',horizontalalignment='center',verticalalignment='center')
plt.text(0.9,0.5,'$r_c$',horizontalalignment='center',verticalalignment='center')
plt.text(0.75,0.375,'$r_{v,2}$',horizontalalignment='center',verticalalignment='center')
plt.text(0.9,0.815,'$r_a$',horizontalalignment='center',verticalalignment='center')
plt.text(0.96,0.185,'$H_s$',verticalalignment='center')
plt.text(0.75,0.75,'$H_{v,1}$',horizontalalignment='center')
plt.text(0.96,0.5,'$H_c$',verticalalignment='center')
plt.text(0.75,0.5,'$H_{v,2}$',horizontalalignment='center')
plt.text(0.96,0.815,'$H$',verticalalignment='center')
plt.text(0.9,-0.07,'$T_s$',horizontalalignment='center')
plt.text(0.93,0.625,'$T_{c,1}$',verticalalignment='center')
plt.text(0.53,0.625,'$T_{v,1}$',verticalalignment='center')
plt.text(0.93,0.375,'$T_{c,2}$',verticalalignment='center')
plt.text(0.53,0.375,'$T_{v,2}$',verticalalignment='center')

plt.arrow(0.15,0.85+0.03,0,-0.1,color='k',head_width=0.02)
plt.text(0.15,0.92,r'$S_{\downarrow\rm dir}$',horizontalalignment='center')
plt.arrow(0.15,0.55,0,-0.1,color='k',head_width=0.02)
plt.text(0.15,0.6,r'$\tau_{b,1}S_{\downarrow\rm dir}$',horizontalalignment='center')
plt.arrow(0.15,0.25,0,-0.1,color='k',head_width=0.02)
plt.text(0.15,0.05,r'$\tau_{b,1}\tau_{b,2}S_{\downarrow\rm dir}$',horizontalalignment='center')
plt.arrow(0.3,0.85+0.03,0,-0.1,color='k',head_width=0.02)
plt.text(0.3,0.92,r'$S_{\downarrow\rm dif}$',horizontalalignment='center')
plt.arrow(0.3,0.55,0,-0.1,color='k',head_width=0.02)
plt.text(0.3,0.6,r'$S_{\downarrow1}$',horizontalalignment='center')
plt.arrow(0.3,0.25,0,-0.1,color='k',head_width=0.02)
plt.text(0.3,0.05,r'$S_{\downarrow2}$',horizontalalignment='center')
plt.arrow(0.45,0.15-0.03,0,0.1,color='k',head_width=0.02)
plt.text(0.45,0.05,r'$S_{\uparrow2}$',horizontalalignment='center')
plt.arrow(0.45,0.75,0,0.1,color='k',head_width=0.02)
plt.arrow(0.45,0.45,0,0.1,color='k',head_width=0.02)
plt.text(0.45,0.38,r'$S_{\uparrow1}$',horizontalalignment='center')
plt.text(0.45,0.92,r'$S_{\uparrow0}$',horizontalalignment='center')

plt.text(-0.05,1,'$z_T$',verticalalignment='center')
plt.text(-0.05,0.75,'$h_c$',verticalalignment='center')
plt.text(-0.05,0.625,'$z_1$',verticalalignment='center')
plt.text(-0.05,0.375,'$z_2$',verticalalignment='center')
plt.text(-0.05,0.25,'$h_b$',verticalalignment='center')
plt.text(-0.05,0.0,'$z_{0h}$',verticalalignment='center')
plt.text(0.97,1,'$T_a$',horizontalalignment='center',verticalalignment='center')
plt.text(0.01,-0.05,'surface')
plt.text(0.01,0.7,'canopy layer 1',verticalalignment='center')
plt.text(0.01,0.3,'canopy layer 2',verticalalignment='center')
plt.text(0.01,1.05,'atmosphere',verticalalignment='center')
plt.ylim(-0.1,1)
plt.axis('off')

plt.tight_layout()
plt.savefig('Figure02.pdf')
